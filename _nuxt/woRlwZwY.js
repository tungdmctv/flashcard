import{f as G,r as c,g as k,h as J,c as u,o as v,a as s,t as a,d as r,i as P,F as B,j,b as C,k as K,n as H,l as O,v as Q}from"./CxFqhSA7.js";import{p as X}from"./C9ZjJIze.js";import{P as Z}from"./BYoDscgR.js";const tt={class:"p-4"},st={class:"flex justify-between items-center mb-6"},et={class:"stats shadow"},ot={class:"stat"},lt={class:"stat-value"},at={class:"stat"},nt={class:"stat-value"},rt={class:"stat"},it={class:"stat-value"},dt={class:"flex justify-center my-4"},ct=["disabled"],ut={class:"px-4 py-2"},vt=["disabled"],pt={class:"overflow-x-auto"},bt={class:"table mx-auto table-xl w-full"},gt={key:0,class:"ml-1"},mt={key:0,class:"ml-1"},ft={key:0,class:"ml-1"},wt={key:0,class:"ml-1"},xt=["onClick"],yt={class:"flex items-center gap-2"},ht=["value"],kt={class:"flex justify-center my-4"},Ct=["disabled"],_t={class:"px-4 py-2"},St=["disabled"],Mt={class:"w-full flex my-4 justify-center"},Pt={class:"modal-box"},$t={class:"modal-action"},Lt={class:"modal-box"},Bt={class:"text-3xl font-bold mb-4 text-center"},zt=["innerHTML"],Dt={class:"modal-action"},Nt={class:"dropdown"},Rt=["value"],z=20,Ft=G({__name:"stat",setup(Tt){const F=c(X.languages),n=c(1),w=new Z("flashcards"),g=c([]),m=c("correct"),p=c("desc"),x=c(!1);function _(e){m.value===e?p.value=p.value==="asc"?"desc":"asc":(m.value=e,p.value="desc")}const U=k(()=>g.value.reduce((e,t)=>{var l;return e+(((l=t.stats)==null?void 0:l.correct)||0)},0)),W=k(()=>g.value.reduce((e,t)=>{var l;return e+(((l=t.stats)==null?void 0:l.incorrect)||0)},0)),D=k(()=>[...g.value].sort((e,t)=>{var h,L,T,V;const l=((h=e.stats)==null?void 0:h.correct)||0,i=((L=t.stats)==null?void 0:L.correct)||0,b=((T=e.stats)==null?void 0:T.incorrect)||0,o=((V=t.stats)==null?void 0:V.incorrect)||0;let d=0;switch(m.value){case"word":d=e.word.localeCompare(t.word);break;case"correct":d=l-i;break;case"incorrect":d=b-o;break;case"successRate":d=S(e)-S(t);break}return p.value==="asc"?d:-d})),E=k(()=>{const e=(n.value-1)*z,t=e+z;return D.value.slice(e,t)}),f=k(()=>Math.ceil(D.value.length/z));function S(e){if(!e.stats)return 0;const t=(e.stats.correct||0)+(e.stats.incorrect||0);if(t===0)return 0;const l=e.stats.correct/t*100;return Math.round(l*100)/100}async function I(){const e=await w.allDocs({include_docs:!0});g.value=e.rows.map(t=>t.doc);for(const t of g.value){if(!t._id)continue;const l=await w.get(t._id),i={correct:0,incorrect:0,lastSeen:Date.now()};await w.put({...l,stats:i})}x.value=!1,N()}async function N(){const e=await w.allDocs({include_docs:!0});g.value=e.rows.filter(t=>{var l;return(l=t.doc)==null?void 0:l.word}).map(t=>t.doc)}J(()=>{N(),q()});const y=c(null),$=c(!1);function Y(e){y.value=e,$.value=!0}function R(){$.value=!1}const M=c("th-TH");async function q(){try{const e=await w.get("app_settings");M.value=e.pronunciationLanguage||"th-TH"}catch(e){console.error("Failed to load settings:",e)}}function A(){if(!y.value)return;const e=new SpeechSynthesisUtterance(y.value.word),t={th:"th-TH",en:"en-US",zh:"zh-CN"};e.lang=t[M.value]??"en-US";const l=window.speechSynthesis.getVoices(),i=l.find(b=>b.lang===e.lang)||l.find(b=>b.lang.startsWith(e.lang.slice(0,2)));i&&(e.voice=i),window.speechSynthesis.cancel(),window.speechSynthesis.speak(e)}return(e,t)=>{var i,b;const l=K;return v(),u(B,null,[s("div",tt,[t[28]||(t[28]=s("h1",{class:"text-2xl font-bold mb-6"},"สถิติการฝึกฝน",-1)),s("div",st,[s("div",et,[s("div",ot,[t[12]||(t[12]=s("div",{class:"stat-title"},"คำศัพท์ทั้งหมด",-1)),s("div",lt,a(g.value.length),1)]),s("div",at,[t[13]||(t[13]=s("div",{class:"stat-title"},"ถูกทั้งหมด",-1)),s("div",nt,a(U.value),1)]),s("div",rt,[t[14]||(t[14]=s("div",{class:"stat-title"},"ผิดทั้งหมด",-1)),s("div",it,a(W.value),1)])])]),s("div",dt,[s("button",{onClick:t[0]||(t[0]=o=>n.value=Math.max(1,n.value-1)),disabled:n.value===1,class:"px-4 py-2 mx-1 rounded border border-gray-300 bg-transparent hover:bg-gray-50 disabled:opacity-50 flex items-center gap-2"},t[15]||(t[15]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1),r(" Previous ")]),8,ct),s("span",ut," Page "+a(n.value)+" of "+a(f.value),1),s("button",{onClick:t[1]||(t[1]=o=>n.value=Math.min(f.value,n.value+1)),disabled:n.value===f.value,class:"px-4 py-2 mx-1 rounded border border-gray-300 bg-transparent hover:bg-gray-50 disabled:opacity-50 flex items-center gap-2"},t[16]||(t[16]=[r(" Next "),s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)]),8,vt)]),s("div",pt,[s("table",bt,[s("thead",null,[s("tr",null,[s("th",{onClick:t[2]||(t[2]=o=>_("word")),class:"cursor-pointer hover:font-bold"},[t[17]||(t[17]=r(" คำศัพท์ ")),m.value==="word"?(v(),u("span",gt,a(p.value==="asc"?"↑":"↓"),1)):P("",!0)]),s("th",{onClick:t[3]||(t[3]=o=>_("correct")),class:"cursor-pointer hover:font-bold"},[t[18]||(t[18]=r(" ถูก ")),m.value==="correct"?(v(),u("span",mt,a(p.value==="asc"?"↑":"↓"),1)):P("",!0)]),s("th",{onClick:t[4]||(t[4]=o=>_("incorrect")),class:"cursor-pointer hover:font-bold"},[t[19]||(t[19]=r(" ผิด ")),m.value==="incorrect"?(v(),u("span",ft,a(p.value==="asc"?"↑":"↓"),1)):P("",!0)]),s("th",{onClick:t[5]||(t[5]=o=>_("successRate")),class:"cursor-pointer hover:font-bold"},[t[20]||(t[20]=r(" อัตราความสำเร็จ ")),m.value==="successRate"?(v(),u("span",wt,a(p.value==="asc"?"↑":"↓"),1)):P("",!0)])])]),s("tbody",null,[(v(!0),u(B,null,j(E.value.filter(o=>o.word),o=>{var d,h;return v(),u("tr",{key:o._id},[s("td",{onClick:L=>Y(o),class:"cursor-pointer hover:text-blue-500 text-2xl"},a(o.word),9,xt),s("td",null,a(((d=o.stats)==null?void 0:d.correct)||0),1),s("td",null,a(((h=o.stats)==null?void 0:h.incorrect)||0),1),s("td",null,[s("div",yt,[s("progress",{class:"progress progress-primary w-32",value:S(o),max:"100"},null,8,ht),s("span",null,a(S(o))+"%",1)])])])}),128))])]),s("div",kt,[s("button",{onClick:t[6]||(t[6]=o=>n.value=Math.max(1,n.value-1)),disabled:n.value===1,class:"px-4 py-2 mx-1 rounded border border-gray-300 bg-transparent hover:bg-gray-50 disabled:opacity-50 flex items-center gap-2"},t[21]||(t[21]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1),r(" Previous ")]),8,Ct),s("span",_t," Page "+a(n.value)+" of "+a(f.value),1),s("button",{onClick:t[7]||(t[7]=o=>n.value=Math.min(f.value,n.value+1)),disabled:n.value===f.value,class:"px-4 py-2 mx-1 rounded border border-gray-300 bg-transparent hover:bg-gray-50 disabled:opacity-50 flex items-center gap-2"},t[22]||(t[22]=[r(" Next "),s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)]),8,St)])]),s("div",Mt,[s("button",{class:"btn btn-error btn-sm",onClick:t[8]||(t[8]=o=>x.value=!0)},[C(l,{name:"radix-icons:reset"}),t[23]||(t[23]=r(" Reset Your Statistics "))])]),s("div",{class:H(["modal",{"modal-open":x.value}])},[s("div",Pt,[t[26]||(t[26]=s("h3",{class:"text-lg font-bold mb-4"},"ยืนยันการ Reset",-1)),t[27]||(t[27]=s("p",null,"คุณต้องการ Reset ประวัติการเล่นของคุณ ใช่หรือไม่?",-1)),s("div",$t,[s("button",{class:"btn btn-error",onClick:I},[C(l,{name:"material-symbols:delete-outline"}),t[24]||(t[24]=r(" ยืนยัน "))]),s("button",{class:"btn",onClick:t[9]||(t[9]=o=>x.value=!1)},[C(l,{name:"bitcoin-icons:cross-filled"}),t[25]||(t[25]=r(" ยกเลิก "))])])]),s("div",{class:"modal-backdrop",onClick:t[10]||(t[10]=o=>x.value=!1)})],2)]),s("div",{class:H(["modal",{"modal-open":$.value}])},[s("div",Lt,[s("h3",Bt,a((i=y.value)==null?void 0:i.word),1),s("p",{class:"mb-4",innerHTML:(b=y.value)==null?void 0:b.meaning.replace(/\n/g,"<br>")},null,8,zt),s("div",Dt,[s("div",Nt,[O(s("select",{"onUpdate:modelValue":t[11]||(t[11]=o=>M.value=o),class:"select select-bordered w-full"},[(v(!0),u(B,null,j(F.value,o=>(v(),u("option",{key:o.code,value:o.code},a(o.name),9,Rt))),128))],512),[[Q,M.value]])]),s("button",{class:"btn",onClick:A},[C(l,{name:"material-symbols:volume-up"}),t[29]||(t[29]=r(" อ่านออกเสียง "))]),s("button",{class:"btn btn-error",onClick:R},[C(l,{name:"bitcoin-icons:cross-filled"}),t[30]||(t[30]=r(" ปิด "))])])]),s("div",{class:"modal-backdrop",onClick:R})],2)],64)}}});export{Ft as default};
