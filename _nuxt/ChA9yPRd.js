import{f as F,r as w,g as _,h as M,c as d,o as i,a as s,t as n,d as u,i as k,F as W,j as P,b as x,k as z,n as E}from"./DYqbC8ci.js";import{P as I}from"./BYoDscgR.js";const L={class:"p-4"},T={class:"flex justify-between items-center mb-6"},Y={class:"stats shadow"},h={class:"stat"},q={class:"stat-value"},A={class:"stat"},G={class:"stat-value"},H={class:"stat"},J={class:"stat-value"},K={class:"overflow-x-auto"},O={class:"table mx-auto table-xl w-full"},Q={key:0,class:"ml-1"},U={key:0,class:"ml-1"},X={key:0,class:"ml-1"},Z={class:"flex items-center gap-2"},tt=["value"],st={class:"w-full flex my-4 justify-center"},ot={class:"modal-box"},et={class:"modal-action"},rt=F({__name:"stat",setup(lt){const f=new I("flashcards"),a=w([]),c=w("correct"),r=w("desc"),v=w(!1);function g(o){c.value===o?r.value=r.value==="asc"?"desc":"asc":(c.value=o,r.value="desc")}const N=_(()=>a.value.reduce((o,t)=>{var l;return o+(((l=t.stats)==null?void 0:l.correct)||0)},0)),R=_(()=>a.value.reduce((o,t)=>{var l;return o+(((l=t.stats)==null?void 0:l.wrong)||0)},0)),V=_(()=>[...a.value].sort((o,t)=>{var S,D,$,B;const l=((S=o.stats)==null?void 0:S.correct)||0,e=((D=t.stats)==null?void 0:D.correct)||0,p=(($=o.stats)==null?void 0:$.wrong)||0,b=((B=t.stats)==null?void 0:B.wrong)||0;let m=0;switch(c.value){case"word":m=o.word.localeCompare(t.word);break;case"correct":m=l-e;break;case"wrong":m=p-b;break}return r.value==="asc"?m:-m}));function C(o){if(!o.stats)return 0;const t=(o.stats.correct||0)+(o.stats.wrong||0);if(t===0)return 0;const l=o.stats.correct/t*100;return Math.round(l*100)/100}async function j(){const o=await f.allDocs({include_docs:!0});a.value=o.rows.map(t=>t.doc);for(const t of a.value){if(!t._id)continue;const l=await f.get(t._id),e={correct:0,incorrect:0,lastSeen:Date.now()};await f.put({...l,stats:e})}v.value=!1,y()}async function y(){const o=await f.allDocs({include_docs:!0});a.value=o.rows.map(t=>t.doc)}return M(y),(o,t)=>{const l=z;return i(),d("div",L,[t[18]||(t[18]=s("h1",{class:"text-2xl font-bold mb-6"},"สถิติการฝึกฝน",-1)),s("div",T,[s("div",Y,[s("div",h,[t[6]||(t[6]=s("div",{class:"stat-title"},"คำศัพท์ทั้งหมด",-1)),s("div",q,n(a.value.length),1)]),s("div",A,[t[7]||(t[7]=s("div",{class:"stat-title"},"ถูกทั้งหมด",-1)),s("div",G,n(N.value),1)]),s("div",H,[t[8]||(t[8]=s("div",{class:"stat-title"},"ผิดทั้งหมด",-1)),s("div",J,n(R.value),1)])])]),s("div",K,[s("table",O,[s("thead",null,[s("tr",null,[s("th",{onClick:t[0]||(t[0]=e=>g("word")),class:"cursor-pointer hover:font-bold"},[t[9]||(t[9]=u(" คำศัพท์ ")),c.value==="word"?(i(),d("span",Q,n(r.value==="asc"?"↑":"↓"),1)):k("",!0)]),s("th",{onClick:t[1]||(t[1]=e=>g("correct")),class:"cursor-pointer hover:font-bold"},[t[10]||(t[10]=u(" ถูก ")),c.value==="correct"?(i(),d("span",U,n(r.value==="asc"?"↑":"↓"),1)):k("",!0)]),s("th",{onClick:t[2]||(t[2]=e=>g("wrong")),class:"cursor-pointer hover:font-bold"},[t[11]||(t[11]=u(" ผิด ")),c.value==="wrong"?(i(),d("span",X,n(r.value==="asc"?"↑":"↓"),1)):k("",!0)]),t[12]||(t[12]=s("th",null,"อัตราความสำเร็จ",-1))])]),s("tbody",null,[(i(!0),d(W,null,P(V.value.filter(e=>e.word),e=>{var p,b;return i(),d("tr",{key:e._id},[s("td",null,n(e.word),1),s("td",null,n(((p=e.stats)==null?void 0:p.correct)||0),1),s("td",null,n(((b=e.stats)==null?void 0:b.wrong)||0),1),s("td",null,[s("div",Z,[s("progress",{class:"progress progress-primary w-32",value:C(e),max:"100"},null,8,tt),s("span",null,n(C(e))+"%",1)])])])}),128))])])]),s("div",st,[s("button",{class:"btn btn-error btn-sm",onClick:t[3]||(t[3]=e=>v.value=!0)},[x(l,{name:"radix-icons:reset"}),t[13]||(t[13]=u(" Reset Your Statistics "))])]),s("div",{class:E(["modal",{"modal-open":v.value}])},[s("div",ot,[t[16]||(t[16]=s("h3",{class:"text-lg font-bold mb-4"},"ยืนยันการ Reset",-1)),t[17]||(t[17]=s("p",null,"คุณต้องการ Reset ประวัติการเล่นของคุณ ใช่หรือไม่?",-1)),s("div",et,[s("button",{class:"btn btn-error",onClick:j},[x(l,{name:"material-symbols:delete-outline"}),t[14]||(t[14]=u(" ยืนยัน "))]),s("button",{class:"btn",onClick:t[4]||(t[4]=e=>v.value=!1)},[x(l,{name:"bitcoin-icons:cross-filled"}),t[15]||(t[15]=u(" ยกเลิก "))])])]),s("div",{class:"modal-backdrop",onClick:t[5]||(t[5]=e=>v.value=!1)})],2)])}}});export{rt as default};
