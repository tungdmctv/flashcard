import{f as O,r as o,g as w,h as Q,c as l,a as t,b as h,i as T,v as G,F as y,k as x,q as J,t as d,d as V,p as K,o as i,l as R,j as X}from"./TdmUD8UC.js";import{u as Y,_ as Z}from"./bgsMDtJH.js";import{P as ee}from"./BYoDscgR.js";import{p as te}from"./C9ZjJIze.js";const se={class:"flex gap-4 mb-6 flex-wrap"},ne={class:"dropdown"},oe={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52 z-[1] max-h-96 overflow-y-auto"},ae={class:"cursor-pointer flex gap-2"},le=["value"],ie={class:"dropdown mx-auto w-full md:w-1/2 flex space-x-2 justify-center items-center"},de=["value"],ue={class:"flex justify-center my-8"},ce={class:"btn-group"},re=["disabled"],ve={class:"btn"},pe=["disabled"],me={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},be={class:"card-body relative"},ge=["onClick"],fe={class:"flex justify-between items-start"},_e={class:"card-title"},we={class:"flex flex-wrap gap-2 mt-2"},he={class:"card-actions justify-end mt-4"},ye=["onClick"],xe=["onClick"],ke={class:"flex justify-center mt-8"},Ce={class:"btn-group"},Se=["disabled"],Te={class:"btn"},Le=["disabled"],Me={class:"modal-box"},De={class:"modal-action"},L=12,Pe=O({__name:"cards",setup(je){const I=o({pronunciationLanguage:"th-TH"});async function P(){try{const s=await b.get("app_settings");I.value={pronunciationLanguage:s.pronunciationLanguage||"th-TH"},g.value=s.pronunciationLanguage||"th-TH"}catch(s){console.error("Failed to load settings:",s)}}function U(s){if(typeof window>"u"||!window.speechSynthesis)return;const e=new SpeechSynthesisUtterance(s||""),u={th:"th-TH",en:"en-US",zh:"zh-CN"};e.lang=u[g.value]??"en-US";const v=window.speechSynthesis.getVoices(),m=v.find(n=>n.lang===e.lang)||v.find(n=>n.lang.startsWith(e.lang.slice(0,2)));m&&(e.voice=m),window.speechSynthesis.cancel(),window.speechSynthesis.speak(e)}const b=new ee("flashcards"),B=o(te.languages),g=o("th-TH"),k=o([]),p=o(""),f=o([]),C=o(),r=o(),H=o(!1),_=o(!1);o(!1);const M=o({word:"",meaning:"",tagsInput:""}),a=o(1);Y();const z=w(()=>Array.from(new Set(k.value.flatMap(s=>s.tags)))),D=w(()=>k.value.filter(s=>{const e=p.value?s.word&&s.word.toLowerCase().includes(p.value.toLowerCase())||s.meaning&&s.meaning.toLowerCase().includes(p.value.toLowerCase()):!0,u=!f.value.length||s.tags&&f.value.every(v=>s.tags.includes(v));return e&&u&&s.word}).sort((s,e)=>(e.updatedAt||0)-(s.updatedAt||0))),j=w(()=>Math.ceil(D.value.length/L)),E=w(()=>{const s=(a.value-1)*L,e=s+L;return D.value.slice(s,e)});function F(){$()}function $(s){s?(C.value=s,M.value={word:s.word,meaning:s.meaning,tagsInput:s.tags.join(", ")}):(C.value=null,M.value={word:"",meaning:"",tagsInput:""}),H.value=!0,setTimeout(()=>{q("edit-modal")},40)}function N(s){r.value=s,_.value=!0}function A(){_.value=!1,r.value=void 0}async function S(){const s=await b.allDocs({include_docs:!0});k.value=s.rows.map(e=>e.doc)}async function W(){var e;if(!((e=r.value)!=null&&e._id))return;const s=await b.get(r.value._id);await b.remove(s),_.value=!1,r.value=null,S()}function q(s=""){const e=document.getElementById(s);e==null||e.classList.add("modal-open")}return Q(()=>{P(),S()}),(s,e)=>{var m;const u=X,v=Z;return i(),l("div",null,[t("div",{class:"flex justify-between items-center mb-6"},[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold"},"จัดการคำศัพท์",-1)),t("button",{class:"btn btn-primary",onClick:F},"เพิ่มคำศัพท์")]),t("div",se,[T(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>p.value=n),type:"text",placeholder:"ค้นหาคำศัพท์...",class:"input input-bordered w-full max-w-xs"},null,512),[[G,p.value]]),t("div",ne,[e[8]||(e[8]=t("label",{tabindex:"0",class:"btn m-1"},"กรองตามแท็ก",-1)),t("ul",oe,[(i(!0),l(y,null,x(z.value.filter(n=>n),n=>(i(),l("li",{key:n},[t("label",ae,[T(t("input",{"onUpdate:modelValue":e[1]||(e[1]=c=>f.value=c),value:n,type:"checkbox",class:"checkbox"},null,8,le),[[R,f.value]]),t("span",null,d(n),1)])]))),128))])])]),t("div",ie,[e[9]||(e[9]=t("div",{class:"hidden md:block"},"อ่านภาษา : ",-1)),T(t("select",{"onUpdate:modelValue":e[2]||(e[2]=n=>g.value=n),class:"select select-bordered"},[(i(!0),l(y,null,x(B.value,n=>(i(),l("option",{key:n.code,value:n.code},d(n.name),9,de))),128))],512),[[J,g.value]])]),t("div",ue,[t("div",ce,[t("button",{class:"btn",disabled:a.value===1,onClick:e[3]||(e[3]=n=>a.value--)},"«",8,re),t("button",ve,"หน้า "+d(a.value),1),t("button",{class:"btn",disabled:a.value>=j.value,onClick:e[4]||(e[4]=n=>a.value++)},"»",8,pe)])]),t("div",me,[(i(!0),l(y,null,x(E.value,n=>(i(),l("div",{key:n._id,class:"card bg-base-200"},[t("div",be,[t("button",{class:"btn btn-circle btn-lg btn-ghost absolute top-2 right-2",onClick:c=>U(n.word),title:"อ่านออกเสียง"},[h(u,{name:"material-symbols:volume-up"})],8,ge),t("div",fe,[t("h2",_e,d(n.word),1)]),t("p",null,d(n.meaning),1),t("div",we,[(i(!0),l(y,null,x(n.tags,c=>(i(),l("span",{key:c,class:"badge badge-primary"},d(c),1))),128))]),t("div",he,[t("button",{class:"btn btn-sm",onClick:c=>$(n)},"แก้ไข",8,ye),t("button",{class:"btn btn-sm btn-error",onClick:c=>N(n)},"ลบ",8,xe)])])]))),128))]),t("div",ke,[t("div",Ce,[t("button",{class:"btn",disabled:a.value===1,onClick:e[5]||(e[5]=n=>a.value--)},"«",8,Se),t("button",Te,"หน้า "+d(a.value),1),t("button",{class:"btn",disabled:a.value>=j.value,onClick:e[6]||(e[6]=n=>a.value++)},"»",8,Le)])]),h(v,{id:"edit-modal",card:C.value,onSaveCard:S},null,8,["card"]),t("div",{class:K(["modal",{"modal-open":_.value}])},[t("div",Me,[e[12]||(e[12]=t("h3",{class:"text-lg font-bold mb-4"},"ยืนยันการลบ",-1)),t("p",null,'คุณต้องการลบคำศัพท์ "'+d((m=r.value)==null?void 0:m.word)+'" ใช่หรือไม่?',1),t("div",De,[t("button",{class:"btn btn-error",onClick:W},[h(u,{name:"material-symbols:delete-outline"}),e[10]||(e[10]=V(" ยืนยัน "))]),t("button",{class:"btn",onClick:A},[h(u,{name:"bitcoin-icons:cross-filled"}),e[11]||(e[11]=V(" ยกเลิก "))])])]),t("div",{class:"modal-backdrop",onClick:A})],2)])}}});export{Pe as default};
