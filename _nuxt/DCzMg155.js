import{j as Q,r,k as f,B as X,l as Y,c as d,a as t,z as Z,m as w,b as k,d as x,F as N,n as j,s as U,t as c,C as R,q as L,D as ee,p as z,o,x as te}from"./DJbcb5zS.js";import{P as se}from"./BYoDscgR.js";import{p as ae}from"./C9ZjJIze.js";const ne={class:"text-lg"},oe={class:"flex justify-end items-center mb-6"},le={class:"flex flex-wrap justify-end gap-4 items-center"},ie={class:"dropdown"},ce={tabindex:"0",class:"btn m-1"},ue={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52"},re={class:"label cursor-pointer justify-start gap-2"},de=["value"],ve={class:"label-text"},pe={class:"w-full flex justify-center"},me={class:"stats shadow mb-6"},fe={class:"stat"},be={class:"stat-value"},ge={class:"stat"},_e={class:"stat-value text-success"},we={class:"stat"},xe={class:"stat-value text-error"},he={class:"card-body items-center text-center"},ye={class:"card-title text-6xl mb-4 py-6"},ke=["innerHTML"],Se={class:"flex gap-4"},Ce={key:1,class:"text-center py-12"},Me={key:2,class:"text-center py-12"},Te={key:3,class:"flex justify-center gap-2 my-4"},Le={class:"dropdown"},De=["value"],Ve={class:"modal"},Be={class:"modal-box relative"},He={class:"mb-2"},Ne={class:"mb-2 text-success"},je={class:"mb-4 text-error"},Ae=Q({__name:"practice",setup(Ue){const b=new se("flashcards"),W=r(ae.languages),h=r("th-TH"),A=r({pronunciationLanguage:"th-TH"}),p=r([]),v=r(0),l=r(!1),u=r(!0),g=r([]),m=r(!1),S=f(()=>p.value.reduce((a,e)=>{var s;return a+(((s=e.stats)==null?void 0:s.correct)||0)},0)),C=f(()=>p.value.reduce((a,e)=>{var s;return a+(((s=e.stats)==null?void 0:s.incorrect)||0)},0)),D=f(()=>S.value+C.value),F=f(()=>[...new Set(p.value.flatMap(a=>a.tags))]),M=f(()=>p.value.filter(a=>g.value.length===0||g.value.some(e=>a.tags.includes(e)))),i=f(()=>M.value[v.value]||null),G=f(()=>{var a;return((a=i.value)==null?void 0:a.meaning.replace(/\n/g,"<br>"))||""});async function O(){const e=(await b.allDocs({include_docs:!0})).rows.map(s=>s.doc).filter(s=>{var n;return s.word&&!((n=s._id)!=null&&n.startsWith("_design"))});p.value=e.map(s=>({...s,tags:s.tags||[],stats:s.stats||{correct:0,incorrect:0,lastSeen:Date.now()}})),u.value&&_()}function _(){v.value=0,l.value=!1,p.value=[...M.value].sort(()=>Math.random()-.5)}function P(){u.value=!u.value,l.value=!1,u.value?_():v.value=0}function $(){l.value||(l.value=!0)}async function V(a){var n;if(!((n=i.value)!=null&&n._id))return;const e=await b.get(i.value._id),s={...e.stats};s[a?"correct":"incorrect"]++,s.lastSeen=Date.now(),await b.put({...e,stats:s}),i.value.stats&&(i.value.stats[a?"correct":"incorrect"]++,i.value.stats.lastSeen=s.lastSeen),l.value=!1,E()}function E(){v.value<M.value.length-1?v.value++:u.value?_():v.value=0,l.value=!1}function I(a){var H;if(typeof window>"u"||!window.speechSynthesis)return;const e=new SpeechSynthesisUtterance(((H=i.value)==null?void 0:H.word)||""),s={th:"th-TH",en:"en-US",zh:"zh-CN"};e.lang=s[a]??"en-US";const n=window.speechSynthesis.getVoices(),y=n.find(T=>T.lang===e.lang)||n.find(T=>T.lang.startsWith(e.lang.slice(0,2)));y&&(e.voice=y),window.speechSynthesis.cancel(),window.speechSynthesis.speak(e)}async function K(){for(const a of p.value){if(!a._id)continue;const e=await b.get(a._id),s={correct:0,incorrect:0,lastSeen:Date.now()};await b.put({...e,stats:s}),a.stats=s}}function q(){m.value=!0}function B(){m.value=!1,l.value=!1,u.value?_():v.value=0}X(g,()=>{v.value=0,l.value=!1,u.value&&_()});async function J(){try{const a=await b.get("app_settings");A.value={pronunciationLanguage:a.pronunciationLanguage||"th-TH"},h.value=a.pronunciationLanguage||"th-TH"}catch(a){console.error("Failed to load settings:",a)}}return Y(()=>{O(),J()}),(a,e)=>{const s=te;return o(),d("div",ne,[t("div",oe,[t("div",le,[t("div",ie,[t("label",ce,[k(s,{name:"material-symbols:label-important-rounded"}),e[6]||(e[6]=x(" Tags "))]),t("ul",ue,[(o(!0),d(N,null,j(F.value,n=>(o(),d("li",{key:n},[t("label",re,[w(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=y=>g.value=y),value:n,class:"checkbox"},null,8,de),[[z,g.value]]),t("span",ve,c(n),1)])]))),128))])]),t("button",{class:"btn",onClick:P},[u.value?(o(),U(s,{key:1,name:"lineicons:sort-amount-asc"})):(o(),U(s,{key:0,name:"fe:random"})),x(" "+c(u.value?"A->B":"Random"),1)]),t("button",{class:"btn btn-warning btn-sm",onClick:K},[k(s,{name:"radix-icons:reset"}),e[7]||(e[7]=x(" Reset "))]),t("button",{class:"btn btn-error btn-sm",onClick:q},[k(s,{name:"ic:baseline-stop-circle"}),e[8]||(e[8]=x(" End "))])])]),t("div",pe,[t("div",me,[t("div",fe,[e[9]||(e[9]=t("div",{class:"stat-title"},"Played",-1)),t("div",be,c(D.value),1)]),t("div",ge,[e[10]||(e[10]=t("div",{class:"stat-title"},"OK",-1)),t("div",_e,c(S.value),1)]),t("div",we,[e[11]||(e[11]=t("div",{class:"stat-title"},"Wrong",-1)),t("div",xe,c(C.value),1)])])]),i.value&&!m.value?(o(),d("div",{key:0,class:"card bg-base-200 max-w-2xl mx-auto cursor-pointer",onClick:$},[t("div",he,[t("h2",ye,c(i.value.word),1),w(t("p",{class:"text-xl mb-4",innerHTML:G.value},null,8,ke),[[R,l.value]]),w(t("div",Se,[t("button",{class:"btn btn-success",onClick:e[1]||(e[1]=L(n=>V(!0),["stop"]))},"OK"),t("button",{class:"btn btn-error",onClick:e[2]||(e[2]=L(n=>V(!1),["stop"]))},"Again")],512),[[R,l.value]])])])):m.value?(o(),d("div",Me,e[13]||(e[13]=[t("p",null,"No cards available.",-1)]))):(o(),d("div",Ce,[e[12]||(e[12]=t("p",{class:"text-xl mb-4"},"No Words Selected",-1)),t("button",{class:"btn btn-primary",onClick:B},"Start")])),i.value&&!m.value?(o(),d("div",Te,[t("div",Le,[w(t("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>h.value=n),class:"select select-bordered w-full"},[(o(!0),d(N,null,j(W.value,n=>(o(),d("option",{key:n.code,value:n.code},c(n.name),9,De))),128))],512),[[ee,h.value]])]),t("button",{class:"btn",onClick:e[4]||(e[4]=L(n=>I(h.value),["stop"]))},[k(s,{name:"material-symbols:volume-up"}),e[14]||(e[14]=x(" ‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á "))])])):Z("",!0),w(t("input",{type:"checkbox",id:"end-modal",class:"modal-toggle","onUpdate:modelValue":e[5]||(e[5]=n=>m.value=n)},null,512),[[z,m.value]]),t("div",Ve,[t("div",Be,[e[15]||(e[15]=t("h3",{class:"text-lg font-bold mb-4"},"‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß üéâ",-1)),t("p",He,"‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ó‡∏≤‡∏¢‡πÑ‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: "+c(D.value),1),t("p",Ne,"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: "+c(S.value),1),t("p",je,"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: "+c(C.value),1),t("div",{class:"modal-action"},[t("button",{class:"btn btn-primary",onClick:B},"‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà")])])])])}}});export{Ae as default};
