import{f as M,r as w,g as k,h as W,c,o as i,a as s,t as n,b as _,d as u,i as j,j as x,F as P,k as z,n as E}from"./BOeNQzT5.js";import{P as I}from"./BYoDscgR.js";const L={class:"p-4"},T={class:"flex justify-between items-center mb-6"},q={class:"stats shadow"},A={class:"stat"},G={class:"stat-value"},H={class:"stat"},J={class:"stat-value"},K={class:"stat"},O={class:"stat-value"},Q={class:"overflow-x-auto"},U={class:"table mx-auto table-xl w-full"},X={key:0,class:"ml-1"},Y={key:0,class:"ml-1"},Z={key:0,class:"ml-1"},h={class:"flex items-center gap-2"},tt=["value"],st={class:"modal-box"},ot={class:"modal-action"},at=M({__name:"stat",setup(et){const f=new I("flashcards"),a=w([]),d=w("correct"),r=w("desc"),v=w(!1);function g(o){d.value===o?r.value=r.value==="asc"?"desc":"asc":(d.value=o,r.value="desc")}const N=k(()=>a.value.reduce((o,t)=>{var l;return o+(((l=t.stats)==null?void 0:l.correct)||0)},0)),R=k(()=>a.value.reduce((o,t)=>{var l;return o+(((l=t.stats)==null?void 0:l.wrong)||0)},0)),V=k(()=>[...a.value].sort((o,t)=>{var S,D,$,B;const l=((S=o.stats)==null?void 0:S.correct)||0,e=((D=t.stats)==null?void 0:D.correct)||0,p=(($=o.stats)==null?void 0:$.wrong)||0,b=((B=t.stats)==null?void 0:B.wrong)||0;let m=0;switch(d.value){case"word":m=o.word.localeCompare(t.word);break;case"correct":m=l-e;break;case"wrong":m=p-b;break}return r.value==="asc"?m:-m}));function C(o){if(!o.stats)return 0;const t=(o.stats.correct||0)+(o.stats.wrong||0);if(t===0)return 0;const l=o.stats.correct/t*100;return Math.round(l*100)/100}async function F(){const o=await f.allDocs({include_docs:!0});a.value=o.rows.map(t=>t.doc);for(const t of a.value){if(!t._id)continue;const l=await f.get(t._id),e={correct:0,incorrect:0,lastSeen:Date.now()};await f.put({...l,stats:e})}v.value=!1,y()}async function y(){const o=await f.allDocs({include_docs:!0});a.value=o.rows.map(t=>t.doc)}return W(y),(o,t)=>{const l=j;return i(),c("div",L,[t[18]||(t[18]=s("h1",{class:"text-2xl font-bold mb-6"},"สถิติการฝึกฝน",-1)),s("div",T,[s("div",q,[s("div",A,[t[6]||(t[6]=s("div",{class:"stat-title"},"คำศัพท์ทั้งหมด",-1)),s("div",G,n(a.value.length),1)]),s("div",H,[t[7]||(t[7]=s("div",{class:"stat-title"},"ถูกทั้งหมด",-1)),s("div",J,n(N.value),1)]),s("div",K,[t[8]||(t[8]=s("div",{class:"stat-title"},"ผิดทั้งหมด",-1)),s("div",O,n(R.value),1)])]),s("button",{class:"btn btn-error btn-sm",onClick:t[0]||(t[0]=e=>v.value=!0)},[_(l,{name:"radix-icons:reset"}),t[9]||(t[9]=u(" Reset "))])]),s("div",Q,[s("table",U,[s("thead",null,[s("tr",null,[s("th",{onClick:t[1]||(t[1]=e=>g("word")),class:"cursor-pointer hover:font-bold"},[t[10]||(t[10]=u(" คำศัพท์ ")),d.value==="word"?(i(),c("span",X,n(r.value==="asc"?"↑":"↓"),1)):x("",!0)]),s("th",{onClick:t[2]||(t[2]=e=>g("correct")),class:"cursor-pointer hover:font-bold"},[t[11]||(t[11]=u(" ถูก ")),d.value==="correct"?(i(),c("span",Y,n(r.value==="asc"?"↑":"↓"),1)):x("",!0)]),s("th",{onClick:t[3]||(t[3]=e=>g("wrong")),class:"cursor-pointer hover:font-bold"},[t[12]||(t[12]=u(" ผิด ")),d.value==="wrong"?(i(),c("span",Z,n(r.value==="asc"?"↑":"↓"),1)):x("",!0)]),t[13]||(t[13]=s("th",null,"อัตราความสำเร็จ",-1))])]),s("tbody",null,[(i(!0),c(P,null,z(V.value.filter(e=>e.word),e=>{var p,b;return i(),c("tr",{key:e._id},[s("td",null,n(e.word),1),s("td",null,n(((p=e.stats)==null?void 0:p.correct)||0),1),s("td",null,n(((b=e.stats)==null?void 0:b.wrong)||0),1),s("td",null,[s("div",h,[s("progress",{class:"progress progress-primary w-32",value:C(e),max:"100"},null,8,tt),s("span",null,n(C(e))+"%",1)])])])}),128))])])]),s("div",{class:E(["modal",{"modal-open":v.value}])},[s("div",st,[t[16]||(t[16]=s("h3",{class:"text-lg font-bold mb-4"},"ยืนยันการ Reset",-1)),t[17]||(t[17]=s("p",null,"คุณต้องการ Reset ประวัติการเล่นของคุณ ใช่หรือไม่?",-1)),s("div",ot,[s("button",{class:"btn btn-error",onClick:F},[_(l,{name:"material-symbols:delete-outline"}),t[14]||(t[14]=u(" ยืนยัน "))]),s("button",{class:"btn",onClick:t[4]||(t[4]=e=>v.value=!1)},[_(l,{name:"bitcoin-icons:cross-filled"}),t[15]||(t[15]=u(" ยกเลิก "))])])]),s("div",{class:"modal-backdrop",onClick:t[5]||(t[5]=e=>v.value=!1)})],2)])}}});export{at as default};
