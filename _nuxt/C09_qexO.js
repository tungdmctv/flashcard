import{u as N,_ as z}from"./DBZ0X5uy.js";import{f as U,r as o,g as f,h as O,c as a,a as t,b as h,l as I,v as Q,F as C,j as k,t as d,d as L,n as q,o as i,m as G,k as H}from"./DGKBXwsW.js";import{P as J}from"./BYoDscgR.js";const K={class:"flex gap-4 mb-6 flex-wrap"},R={class:"dropdown"},W={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52 z-[1] max-h-96 overflow-y-auto"},X={class:"cursor-pointer flex gap-2"},Y=["value"],Z={class:"flex justify-center my-8"},ee={class:"btn-group"},te=["disabled"],se={class:"btn"},ne=["disabled"],oe={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},le={class:"card-body"},ae={class:"card-title"},de={class:"flex flex-wrap gap-2 mt-2"},ie={class:"card-actions justify-end mt-4"},ue=["onClick"],ce=["onClick"],re={class:"flex justify-center mt-8"},ve={class:"btn-group"},me=["disabled"],be={class:"btn"},pe=["disabled"],fe={class:"modal-box"},_e={class:"modal-action"},y=10,Ce=U({__name:"cards",setup(ge){const _=new J("flashcards");o(!1),o("");const g=o([]),r=o(""),v=o([]),m=o(null),u=o(null);o(!1);const b=o(!1);o(!1);const D=o({word:"",meaning:"",tagsInput:""}),l=o(1);N();const P=f(()=>Array.from(new Set(g.value.flatMap(s=>s.tags)))),M=f(()=>g.value.filter(s=>{const e=r.value?s.word&&s.word.toLowerCase().includes(r.value.toLowerCase())||s.meaning&&s.meaning.toLowerCase().includes(r.value.toLowerCase()):!0,x=!v.value.length||s.tags&&v.value.every(p=>s.tags.includes(p));return e&&x&&s.word}).sort((s,e)=>(e.updatedAt||0)-(s.updatedAt||0))),T=f(()=>Math.ceil(M.value.length/y)),B=f(()=>{const s=(l.value-1)*y,e=s+y;return M.value.slice(s,e)});function V(){$()}function $(s){s?(m.value=s,D.value={word:s.word,meaning:s.meaning,tagsInput:s.tags.join(", ")}):(m.value={},setTimeout(()=>{m.value=null},10),D.value={word:"",meaning:"",tagsInput:""}),setTimeout(()=>{E("edit-modal")},40)}function E(s=""){const e=document.getElementById(s);e==null||e.classList.add("modal-open")}function S(s){u.value=s,b.value=!0}function j(){b.value=!1,u.value=null}async function w(){const s=await _.allDocs({include_docs:!0});g.value=s.rows.map(e=>e.doc)}async function F(){var e;if(!((e=u.value)!=null&&e._id))return;const s=await _.get(u.value._id);await _.remove(s),b.value=!1,u.value=null,w()}return O(w),(s,e)=>{var A;const x=z,p=H;return i(),a("div",null,[t("div",{class:"flex justify-between items-center mb-6"},[e[6]||(e[6]=t("h1",{class:"text-2xl font-bold"},"จัดการคำศัพท์",-1)),t("button",{class:"btn btn-primary",onClick:V},"เพิ่มคำศัพท์")]),t("div",K,[I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>r.value=n),type:"text",placeholder:"ค้นหาคำศัพท์...",class:"input input-bordered w-full max-w-xs"},null,512),[[Q,r.value]]),t("div",R,[e[7]||(e[7]=t("label",{tabindex:"0",class:"btn m-1"},"กรองตามแท็ก",-1)),t("ul",W,[(i(!0),a(C,null,k(P.value.filter(n=>n),n=>(i(),a("li",{key:n},[t("label",X,[I(t("input",{"onUpdate:modelValue":e[1]||(e[1]=c=>v.value=c),value:n,type:"checkbox",class:"checkbox"},null,8,Y),[[G,v.value]]),t("span",null,d(n),1)])]))),128))])])]),t("div",Z,[t("div",ee,[t("button",{class:"btn",disabled:l.value===1,onClick:e[2]||(e[2]=n=>l.value--)},"«",8,te),t("button",se,"หน้า "+d(l.value),1),t("button",{class:"btn",disabled:l.value>=T.value,onClick:e[3]||(e[3]=n=>l.value++)},"»",8,ne)])]),t("div",oe,[(i(!0),a(C,null,k(B.value,n=>(i(),a("div",{key:n._id,class:"card bg-base-200"},[t("div",le,[t("h2",ae,d(n.word),1),t("p",null,d(n.meaning),1),t("div",de,[(i(!0),a(C,null,k(n.tags,c=>(i(),a("span",{key:c,class:"badge badge-primary"},d(c),1))),128))]),t("div",ie,[t("button",{class:"btn btn-sm",onClick:c=>$(n)},"แก้ไข",8,ue),t("button",{class:"btn btn-sm btn-error",onClick:c=>S(n)},"ลบ",8,ce)])])]))),128))]),t("div",re,[t("div",ve,[t("button",{class:"btn",disabled:l.value===1,onClick:e[4]||(e[4]=n=>l.value--)},"«",8,me),t("button",be,"หน้า "+d(l.value),1),t("button",{class:"btn",disabled:l.value>=T.value,onClick:e[5]||(e[5]=n=>l.value++)},"»",8,pe)])]),h(x,{id:"edit-modal",card:m.value,onSaveCard:w},null,8,["card"]),t("div",{class:q(["modal",{"modal-open":b.value}])},[t("div",fe,[e[10]||(e[10]=t("h3",{class:"text-lg font-bold mb-4"},"ยืนยันการลบ",-1)),t("p",null,'คุณต้องการลบคำศัพท์ "'+d((A=u.value)==null?void 0:A.word)+'" ใช่หรือไม่?',1),t("div",_e,[t("button",{class:"btn btn-error",onClick:F},[h(p,{name:"material-symbols:delete-outline"}),e[8]||(e[8]=L(" ยืนยัน "))]),t("button",{class:"btn",onClick:j},[h(p,{name:"bitcoin-icons:cross-filled"}),e[9]||(e[9]=L(" ยกเลิก "))])])]),t("div",{class:"modal-backdrop",onClick:j})],2)])}}});export{Ce as default};
